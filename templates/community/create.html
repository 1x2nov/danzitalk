{% extends "base.html" %}

{% load static %}
{% block extrahead %}
<link rel="stylesheet" href="{% static 'css/community/create.css' %}">
{% endblock %}

{% block navbar %}
{% endblock %}
{% block content %}
<div id="main" class="d-flex flex-column">
    <header class="navbar navbar-expand-lg navbar-dark bd-navbar sticky-top border-bottom" id="navbar">
        <nav class="container-xxl bd-gutter flex-wrap flex-lg-nowrap" style="max-width: none;">
                <span class="material-symbols-outlined">
                    <a style="display:flex; color: black; text-decoration: none; width: 0; margin: 0;" href="/community/{{reality_id}}">arrow_back</a>
                </span>
            <div>글쓰기</div>
            <div>
                <button class="justify-content-end d-flex p-0"style="width: 0; white-space: nowrap;"id="submit-button">등록</button>
            </div>
        </nav>
    </header>
    <div class="border-bottom p-3" id="posting-title">
        <input id="input-title" type="text" placeholder="제목">
    </div>
    <div class="p-3" id="content">
        <textarea id="input-content" type="text" placeholder="내용"></textarea>
    </div>
</div>
{% endblock %}
{% block script %}
<script>
$('#submit-button').click(function() {
    let title = $('#input-title').val().trim();
    let content = $('#input-content').val().trim();
    let user_id = "{{ user.id }}";
    let reality_id = "{{ reality_id }}";

    if (title == '') return alert('제목을 입력하세요');
    if (content == '') return alert('내용을 입력하세요');

    $.ajax({
        url: "/community/{{reality_id}}/create",
        data: {
            title: title,
            content: content,
            user_id: user_id,
            reality_id: reality_id
        },
        type: "POST",
        success: function (data) {
            console.log("Success : Create posting button", data);
            location.replace("/community/{{reality_id}}");
        },
        error: function (request, status, error) {
            console.log("Error : Create posting button", request, status, error);
        },
        complete: function (data) {
            console.log("Complete : Create posting button", data);
        }
    });
})
</script>
{% endblock %}